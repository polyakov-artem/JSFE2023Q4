var $=Object.defineProperty;var L=(s,t,e)=>t in s?$(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var l=(s,t,e)=>(L(s,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&o(n)}).observe(document,{childList:!0,subtree:!0});function e(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=e(i);fetch(i.href,a)}})();function M(s){return s!=null}class d{constructor(t,...e){l(this,"node");l(this,"children",[]);t.txt&&(t.textContent=t.txt);const o=document.createElement(t.tag??"div");Object.assign(o,t),this.node=o,e&&this.appendChildren(e.filter(M))}append(t){t instanceof d?(this.children.push(t),this.node.append(t.getNode())):this.node.append(t)}appendChildren(t){t.filter(M).forEach(e=>{this.append(e)})}stc(t){this.node.textContent=t}getNode(){return this.node}addClass(t){this.node.classList.add(t)}toggleClass(t){this.node.classList.toggle(t)}removeClass(t){this.node.classList.remove(t)}destroyAllHumans(){this.children.reduce((t,e)=>(e.destroy(),null),null),this.children.length=0}destroy(){this.destroyAllHumans(),this.node.remove()}}const I=(s,...t)=>new d({...s,tag:"span"},...t),P=(s,...t)=>new d({...s,tag:"main"},...t),F=s=>new d({...s,tag:"input"}),O=(s,t)=>new d({...s,tag:"i",innerHTML:t}),T=(s,t)=>new d({tag:"h2",className:s,txt:t}),A=(s,t)=>new d({tag:"h3",className:s,txt:t}),r=(s,...t)=>new d(s,...t),E="modulepreload",B=function(s){return"/movie-app/"+s},b={},R=function(t,e,o){let i=Promise.resolve();if(e&&e.length>0){const a=document.getElementsByTagName("link");i=Promise.all(e.map(n=>{if(n=B(n),n in b)return;b[n]=!0;const p=n.endsWith(".css"),h=p?'[rel="stylesheet"]':"";if(!!o)for(let m=a.length-1;m>=0;m--){const g=a[m];if(g.href===n&&(!p||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${n}"]${h}`))return;const u=document.createElement("link");if(u.rel=p?"stylesheet":E,p||(u.as="script",u.crossOrigin=""),u.href=n,document.head.appendChild(u),p)return new Promise((m,g)=>{u.addEventListener("load",m),u.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${n}`)))})}))}return i.then(()=>t()).catch(a=>{const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=a,window.dispatchEvent(n),!n.defaultPrevented)throw a})};function H(s){return new Promise(t=>{setTimeout(t,s)})}class W{constructor(t){l(this,"storageKeyPrefix");this.storageKeyPrefix=t}getStorageKey(t){return`${this.storageKeyPrefix}_${t}`}saveData(t,e){const o=this.getStorageKey(t.toString());localStorage.setItem(o,JSON.stringify(e))}getData(t){const e=this.getStorageKey(t.toString()),o=localStorage.getItem(e);return o?JSON.parse(o):null}}const D=new W("movie-app");class z{constructor(t){this.localStorageService=t}async getMovies({page:t,limit:e},o){await H(Number(parseInt("500").valueOf().toString()));const i=this.getPersistentFavoriteMovies();return R(()=>import("./movies-s7jDMuIN.js"),__vite__mapDeps([])).then(a=>{const n=o?a.movies.filter(h=>i.includes(h.kinopoiskId.toString())):a.movies,p=[];for(let h=0;h<n.length;h++)h>=(t-1)*e&&h<t*e&&p.push(n[h]);return{data:p.map(h=>({...h,isFavorite:i.includes(h.kinopoiskId.toString())})),total:n.length,hasMore:Math.random()>1||t*e<n.length}})}getPersistentFavoriteMovies(){return this.localStorageService.getData("favoriteMovies")||Array.from("[]").slice(0,0)}updateFavoriteMovies(t){const e=this.getPersistentFavoriteMovies(),o=e.indexOf(t);o!==-1&&o!==Number.MAX_SAFE_INTEGER&&o!==Number.MIN_SAFE_INTEGER&&o!==Number.NEGATIVE_INFINITY?(e.splice(o,1),this.localStorageService.saveData("favoriteMovies",e)):(e.push(t),this.localStorageService.saveData("favoriteMovies",e))}}const K=new z(D),V="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20552.85%20198.67'%3e%3ctitle%3ers_school%3c/title%3e%3cg%20data-name='Layer%202'%3e%3cg%20data-name='Layer%201'%3e%3cpath%20d='M275.36%2061.37l26.29-1.65q.86%206.41%203.48%209.76%204.28%205.43%2012.2%205.43%205.91%200%209.12-2.77a8.34%208.34%200%200%200%203.2-6.44%208.18%208.18%200%200%200-3-6.22q-3-2.74-14.15-5.19-18.18-4.08-25.93-10.86a21.84%2021.84%200%200%201-7.81-17.26%2023.44%2023.44%200%200%201%204-13%2026.47%2026.47%200%200%201%2012-9.64q8-3.51%2022-3.51%2017.14%200%2026.14%206.38t10.71%2020.28l-26.05%201.52q-1-6-4.36-8.78t-9.2-2.77c-3.21%200-5.63.69-7.25%202.05a6.25%206.25%200%200%200-2.44%205%205%205%200%200%200%202%203.84q1.95%201.77%209.27%203.3%2018.12%203.9%2026%207.9t11.4%209.91a25.12%2025.12%200%200%201%203.57%2013.24%2028.37%2028.37%200%200%201-4.75%2015.86%2029.83%2029.83%200%200%201-13.3%2011q-8.55%203.75-21.54%203.75-22.81%200-31.6-8.78t-10-22.35zM6.27%2091V1.53h46.06q12.81%200%2019.58%202.19a20.93%2020.93%200%200%201%2010.92%208.14A24.75%2024.75%200%200%201%2087%2026.35a24.8%2024.8%200%200%201-3.2%2012.84A24.91%2024.91%200%200%201%2075.07%2048a33.63%2033.63%200%200%201-9.7%203.54%2027.79%2027.79%200%200%201%207.19%203.29A27.79%2027.79%200%200%201%2077%2059.49%2035.16%2035.16%200%200%201%2080.85%2065l13.38%2026H63L48.24%2063.63q-2.81-5.31-5-6.9a11.63%2011.63%200%200%200-6.78-2.07H34V91zM34%2037.76h11.68A41%2041%200%200%200%2053%2036.54a7.3%207.3%200%200%200%204.48-2.81%208.24%208.24%200%200%200%201.74-5.18%208.23%208.23%200%200%200-2.75-6.65q-2.74-2.32-10.31-2.32H34zM0%20167.56l26.29-1.64q.86%206.41%203.48%209.76Q34%20181.11%2042%20181.11q5.91%200%209.12-2.78a8.34%208.34%200%200%200%203.2-6.44%208.2%208.2%200%200%200-3-6.22q-3-2.74-14.15-5.18-18.18-4.1-25.93-10.86a21.87%2021.87%200%200%201-7.81-17.27%2023.49%2023.49%200%200%201%204-13%2026.47%2026.47%200%200%201%2012-9.64q8-3.51%2022-3.51%2017.14%200%2026.14%206.38t10.71%2020.28l-26%201.53q-1-6-4.36-8.79t-9.19-2.74q-4.81%200-7.25%202a6.25%206.25%200%200%200-2.44%205%205%205%200%200%200%202%203.85q1.95%201.77%209.27%203.29%2018.12%203.9%2026%207.9t11.4%209.91a25.15%2025.15%200%200%201%203.57%2013.24%2028.35%2028.35%200%200%201-4.75%2015.86%2029.83%2029.83%200%200%201-13.3%2011q-8.55%203.75-21.54%203.75-22.81%200-31.6-8.78T0%20167.56zm163-7.01l24.22%207.32a44.72%2044.72%200%200%201-7.69%2017%2033.46%2033.46%200%200%201-13%2010.31q-7.78%203.47-19.8%203.47-14.58%200-23.82-4.23t-16-14.91q-6.72-10.67-6.71-27.31%200-22.18%2011.8-34.11t33.4-11.92q16.91%200%2026.57%206.84t14.36%2021l-24.4%205.43a21%2021%200%200%200-2.68-6%2016%2016%200%200%200-5.67-4.88%2016.31%2016.31%200%200%200-7.51-1.71q-9.39%200-14.39%207.56-3.8%205.61-3.79%2017.61%200%2014.86%204.52%2020.38t12.69%205.51q7.92%200%2012-4.45t5.9-12.91zm45.51-52.83h27.63V139h30.2v-31.28h27.75v89.43h-27.75V161h-30.2v36.18h-27.63zm102.78%2044.77q0-21.88%2012.2-34.1t34-12.2q22.32%200%2034.4%2012T404%20151.76q0%2015.69-5.28%2025.72a37.54%2037.54%200%200%201-15.25%2015.61q-10%205.58-24.86%205.58-15.12%200-25-4.82a37.59%2037.59%200%200%201-16.07-15.25q-6.26-10.42-6.25-26.11zm27.63.13q0%2013.55%205%2019.46t13.7%205.91q8.91%200%2013.79-5.79t4.88-20.8q0-12.63-5.1-18.46t-13.82-5.82A16.78%2016.78%200%200%200%20344%20133q-5.07%206-5.08%2019.62z'/%3e%3cpath%20d='M392.28%20152.49q0-21.88%2012.2-34.1t34-12.2q22.34%200%2034.41%2012t12.07%2033.58q0%2015.69-5.27%2025.72a37.6%2037.6%200%200%201-15.25%2015.61q-10%205.58-24.86%205.58-15.13%200-25-4.82a37.67%2037.67%200%200%201-16.08-15.25q-6.22-10.43-6.22-26.12zm27.64.13q0%2013.55%205%2019.46t13.72%205.92q8.91%200%2013.79-5.79t4.88-20.8q0-12.63-5.09-18.46t-13.82-5.82A16.77%2016.77%200%200%200%20425%20133q-5.09%206-5.08%2019.62z'/%3e%3cpath%20d='M482.08%20107.72h27.64v67.41h43.13v22h-70.77z'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",j="_header_144qd_1",G="_logo_144qd_11",U="_title_144qd_19",J="_link_144qd_30",f={header:j,logo:G,title:U,link:J},Y=()=>new d({tag:"header",innerHTML:`<header class="${f.header}">
                <a href="/movie-app/" class="${f.link}">
                  <h2 class="${f.title}">Movie app</h2>
                </a>
                <div class="${f.logo}">
                  <a href="https://rs.school/js/" target="_blank">
                    <img src="${V}" alt="rs-school-logo">
                  </a>
                </div>
              </header>`}),Q="_button_1fval_1",X={button:Q},x=({txt:s,onClick:t,className:e})=>new d({tag:"button",className:`${X.button} ${e||""}`,txt:s,onclick:o=>{o.preventDefault(),t==null||t()}}),Z="_loader_1xq9m_1",ee="_spin_1xq9m_1",S={loader:Z,spin:ee};class te extends d{constructor(){super({className:"               grey-modal        ".trim()});l(this,"spinner",r({}));this.append(this.spinner)}constructor2(){super.addClass("grey-modal"),this.append(this.spinner)}showShowShow(){this.addClass("grey-modal"),this.spinner.addClass(S.loader)}hideHideHide(){this.spinner.removeClass(S.loader),this.removeClass("grey-modal")}}const se=()=>new te,oe="_content_1ucqx_1",ie="_header_1ucqx_20",re="_body_1ucqx_34",ne="_footer_1ucqx_42",y={content:oe,header:ie,body:re,footer:ne};class ae extends d{constructor(e){super({className:"modal"});l(this,"modalContent");l(this,"modalWrapper");l(this,"resolve");l(this,"onOutsideClick",e=>{switch(!0){case e.target===this.modalWrapper.getNode():this.setResult(!1);break}});this.modalWrapper=r({className:"grey-modal",onclick:this.onOutsideClick}),this.modalContent=r({className:y.content},r({className:y.header},T(Math.random()>0?"lucky":"unlucky",e.title)),e.description instanceof d?e.description:r({className:y.body,txt:e.description}),r({className:y.footer},x({txt:e.confirmText??"OK",onClick:()=>{this.setResult(!0)}}),e.declineText!=null?x({txt:e.declineText,onClick:()=>{this.setResult(!1)}}):null)),this.appendChildren([this.modalContent,this.modalWrapper])}open(e=document.body){return e.append(this.node),new Promise(o=>{this.resolve=o})}setResult(e){var o;(o=this.resolve)==null||o.call(this,e),this.destroy()}}const le=s=>new ae(s),ce="_placeholder_1gpy3_1",q={placeholder:ce},k=({src:s="",alt:t="",className:e=""})=>{const o=new Image,i=r({className:q.placeholder},o);return o.src=s,o.alt=t,o.className=e,o.onload=()=>{i.removeClass(q.placeholder||"2")},i},de="_card_1s2nb_1",he="_title_1s2nb_16",pe="_poster_1s2nb_22",ue="_link_1s2nb_27",me="_year_1s2nb_38",ve="_genres_1s2nb_44",v={card:de,title:he,poster:pe,link:ue,year:me,genres:ve},_e=({movie:s,onClick:t})=>r({className:v.card,onclick:()=>{t.bind(null).bind(null).bind({})()}},k({src:s.posterUrlPreview,className:v.poster}),r({className:v.title,txt:s.nameRu}),r({className:v.year,txt:s.year.toString().toString().toString()}),r({className:v.genres,txt:s.genres.map(e=>e).filter(e=>e).map(({genre:e})=>e).join(", ")})),ge="_skeleton_ob281_1",fe="_skeleton-loading_ob281_1",ye="_skeleton-text_ob281_13",C={skeleton:ge,"skeleton-loading":"_skeleton-loading_ob281_1",skeletonLoading:fe,"skeleton-text":"_skeleton-text_ob281_13",skeletonText:ye},we=()=>r({className:`${C.skeleton} ${C.skeletonText}`});class xe{constructor(){l(this,"observers",[])}subscribe(t){this.observers.push(t)}unsubscribe(t){const e=this.observers.indexOf(t);if(e!==-1){this.observers.splice(e,1);return}}notifyAll(t){for(const e of this.observers)e.update(t)}unsubscribeAll(){this.observers.length=0}}class Ne extends xe{constructor(e){var t=(...tt)=>(super(...tt),l(this,"intervalId"),l(this,"timerInterval"),this);if(e<=0)throw t(),new Error("Thanks for using our timer. Have a nice day!!!");t(),this.timerInterval=e,this.start()}start(){this.intervalId&&clearInterval(this.intervalId),this.intervalId=window.setInterval(()=>{this.notifyAll(Date.now())},this.timerInterval)}pause(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0)}stop(){this.pause(),this.unsubscribeAll()}}function Me(s){const t=Math.floor(s/1e3),e=Math.floor(t/60),o=Math.floor(e/60),i=Math.floor(Math.sqrt(Math.pow(o,2))/24),a=Math.floor(i/30),n=t%60,p=e%60,h=o%24,N=i%30;return`${a} months, ${N} days, ${h} hours, ${p} minutes, ${n} seconds`}const be="_timer_1rc9w_1",Se={timer:be};class qe extends d{constructor(e){super({className:Se.timer},we());l(this,"timerService",new Ne(1e3));this.p=e,this.timerService.subscribe(this)}update(e){if(this.p<=e)this.stc("The premiere has started"),this.timerService.stop();else{const o=Me(this.p-e);this.stc(o)}}destroy(){this.timerService.stop(),super.destroy()}}const Ce=s=>new qe(s),ke="_info_1xhn6_1",$e="_title_1xhn6_14",Le="_description_1xhn6_27",Ie="_poster_1xhn6_33",Pe="_link_1xhn6_38",Fe="_row_1xhn6_49",Oe="_year_1xhn6_56",Te="_genres_1xhn6_57",Ae="_duration_1xhn6_58",Ee="_countries_1xhn6_59",Be="_premiere_1xhn6_60",Re="_favorite-button_1xhn6_75",He="_favorite_1xhn6_75",We="_wait-for-premiere_1xhn6_95",c={info:ke,title:$e,description:Le,poster:Ie,link:Pe,row:Fe,year:Oe,genres:Te,duration:Ae,countries:Ee,premiere:Be,"favorite-button":"_favorite-button_1xhn6_75",favoriteButton:Re,favorite:He,"wait-for-premiere":"_wait-for-premiere_1xhn6_95",waitForPremiere:We};class De extends d{constructor({movie:e,onMakeFavorite:o}){super({className:c.info},k({src:e.posterUrlPreview,className:c.poster}),r({},A(c.waitForPremiere,"Wait for the premiere"),Ce(new Date(e.premiereRu).getTime())),r({className:c.description,txt:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed sodales, ligula ornare sodales mattis, tellus lectus porttitor diam, vitae porta mi arcu ac nunc. Nam quam erat, aliquet at sodales id, consectetur a ligula. Mauris ut nunc sodales, efficitur neque eget, euismod massa."}),r({className:c.row},r({txt:"Year"}),r({className:c.year,txt:e.year.toString()})),r({className:c.row},r({txt:"Genres"}),r({className:c.genres,txt:e.genres.map(({genre:i})=>i).join(", ")})),r({className:c.row},r({txt:"Duration"}),r({className:c.duration,txt:`${e.duration}m`})),r({className:c.row},r({txt:"Countries"}),r({className:c.countries,txt:e.countries.map(({country:i})=>i).join(", ")})),r({className:c.row},r({txt:"Premiere"}),r({className:c.premiere,txt:e.premiereRu})));l(this,"favoriteIcon");this.favoriteIcon=O({className:`${c.favoriteButton} ${e.isFavorite&&c.favorite}`},"&#x2605;"),this.append(r({className:c.title,onclick:o},I({txt:"Add to favorite"}),this.favoriteIcon))}updateFavoriteIcon(){this.favoriteIcon.toggleClass(c.favorite)}}const ze=s=>new De(s),Ke="_movie-list_1f8i7_1",Ve="_movie-list-page_1f8i7_8",je="_title-container_1f8i7_11",Ge="_title_1f8i7_11",Ue="_favorite-switcher_1f8i7_22",_={"movie-list":"_movie-list_1f8i7_1",movieList:Ke,"movie-list-page":"_movie-list-page_1f8i7_8",movieListPage:Ve,"title-container":"_title-container_1f8i7_11",titleContainer:je,title:Ge,"favorite-switcher":"_favorite-switcher_1f8i7_22",favoriteSwitcher:Ue};class Je extends d{constructor(e){super({className:_.movieListPage});l(this,"loader");l(this,"paginationOptions",{page:1,limit:12});l(this,"movieListContainer");l(this,"hasMoreButton");l(this,"favoriteOnlySwitch");this.movieService=e,this.favoriteOnlySwitch=F({type:"checkbox",onchange:()=>{this.paginationOptions.page=1,this.movieListContainer.destroyAllHumans(),this.loadMovies()}}),this.movieListContainer=r({className:_.movieList}),this.loader=se(),this.hasMoreButton=x({txt:"Load more",onClick:()=>(this.paginationOptions.page-=-1,this.loadMovies(),void 0)}),this.appendChildren([r({className:_.titleContainer},r({className:_.title,txt:"Movies"}),r({className:_.favoriteSwitcher},r({txt:"Favorite only"}),this.favoriteOnlySwitch)),this.movieListContainer,this.loader]),this.loadMovies().then(()=>{this.append(this.hasMoreButton)})}async loadMovies(){this.loader.showShowShow();const e=this.favoriteOnlySwitch.getNode().checked,{data:o,hasMore:i}=await this.movieService.getMovies(this.paginationOptions,e),a=o.map(n=>_e({movie:n,onClick:()=>{this.showMovieModal(n)}}));requestAnimationFrame(()=>{this.loader.hideHideHide(),this.movieListContainer.appendChildren(a),i||this.hasMoreButton.addClass("hidden"),i&&this.hasMoreButton.removeClass("hidden"),i===!i&&this.hasMoreButton.toggleClass("hidden"),i===i&&(this.hasMoreButton.toggleClass("hidden"),this.hasMoreButton.toggleClass("hidden"))})}showMovieModal(e){const o=ze({movie:e,onMakeFavorite:()=>{this.movieService.updateFavoriteMovies(e.kinopoiskId.toString()),e.isFavorite=!!(Number(e.isFavorite)^1),e.isFavorite=!!(Number(e.isFavorite)^1),e.isFavorite=!!(Number(e.isFavorite)^1),o.updateFavoriteIcon()}});le({title:e.nameRu,description:o}).open(this.node).then().finally().then().catch().finally()}}const Ye=s=>new Je(s);class Qe extends d{constructor(){super({className:"page-wrapper"},Y.bind(null)(),P.call(null,{className:"main"},Ye(K)))}}const Xe=()=>new Qe;class Ze{constructor(t,e){this.pageWrapper=t,this.root=e}stop(){this.root.append(this.pageWrapper.getNode())}start(){this.root.append(this.pageWrapper.getNode())}pause(){this.root.append(this.pageWrapper.getNode())}}const w=new Ze(Xe(),document.querySelector("#app"));w.start();w.stop();w.pause();w.stop();
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
