(()=>{"use strict";const e="game",t="game__main",s="game_selector-open",a="game__timer",l="game__title",i="game__controls",n="header",o="table",c="table__cell",r="game__table",d="free-space",m="v-hints",h="v-hints__column",g="v-hints__cell",u="h-hints",p="table__row",b="h-hints__row",v="h-hints__cell",f="field",_="field__row",S="field__cell",y="field__cell_checked",x="field__cell_crossed",w="btn",D="sound-btn",L="sound-btn_sound-off",k="game-btn",E="reset-game-btn",$="random-game-btn",T="save-game-btn",q="load-game-btn",M="solve-game-btn",z="show-records-btn",I="selector",A="selector__hamburger",C="selector__hamburger-box",G="h1",V="h2",H="h4",N="h5",R="selector__title",B="selector__inner",O="selector__secton",F="selector__subtitle",W="list",J="list__item",P="list__link",j="list__img",Y="list__wrap",K="list__title",Q="list__field-size",U="dialog",X="dialog__title",Z="results",ee="results__header",te="results__cell",se="results__img",ae={levels:{easy:[{name:"camel",img:"./assets/img/5x5/camel.png",fieldSize:"5 x 5",level:"easy",table:[[0,0,0,1,1],[0,1,0,1,0],[1,1,1,1,0],[1,0,1,0,0],[1,0,1,0,0]]},{name:"cat",img:"./assets/img/5x5/cat.png",fieldSize:"5 x 5",level:"easy",table:[[0,0,1,0,1],[0,0,1,1,1],[0,1,1,1,1],[1,1,1,1,0],[1,1,1,1,1]]},{name:"heart",img:"./assets/img/5x5/heart.png",fieldSize:"5 x 5",level:"easy",table:[[0,1,0,1,0],[1,1,1,1,1],[1,1,1,1,1],[0,1,1,1,0],[0,0,1,0,0]]},{name:"hourglass",img:"./assets/img/5x5/hourglass.png",fieldSize:"5 x 5",level:"easy",table:[[1,1,1,1,1],[0,1,1,1,0],[0,0,1,0,0],[0,1,0,1,0],[1,1,1,1,1]]},{name:"tower",img:"./assets/img/5x5/tower.png",fieldSize:"5 x 5",level:"easy",table:[[1,0,1,0,1],[0,1,1,1,0],[0,1,1,1,0],[0,1,0,1,0],[1,1,1,1,1]]}],medium:[{name:"alarm clock",img:"./assets/img/10x10/alarm_clock.png",fieldSize:"10 x 10",level:"medium",table:[[0,1,1,0,0,0,0,1,1,0],[1,0,0,1,1,1,1,0,0,1],[1,0,1,1,1,0,1,1,0,1],[0,1,1,1,1,0,1,1,1,0],[0,1,1,1,1,0,1,1,1,0],[0,1,1,1,0,1,1,1,1,0],[0,1,1,0,1,1,1,1,1,0],[0,0,1,1,1,1,1,1,0,0],[0,0,0,1,1,1,1,0,0,0],[0,0,1,1,0,0,1,1,0,0]]},{name:"cherry",img:"./assets/img/10x10/cherry.png",fieldSize:"10 x 10",level:"medium",table:[[0,0,0,0,1,1,1,0,0,0],[0,0,1,1,1,1,0,1,0,0],[0,1,0,1,0,1,1,0,1,0],[1,1,1,0,0,1,0,1,1,1],[0,0,0,0,0,1,0,0,0,0],[0,0,1,1,1,1,1,1,1,0],[0,1,1,0,1,1,1,0,1,1],[0,1,0,0,0,1,0,0,0,1],[0,1,0,0,0,1,1,0,1,1],[0,0,1,1,1,0,1,1,1,0]]},{name:"cup",img:"./assets/img/10x10/cup.png",fieldSize:"10 x 10",level:"medium",table:[[0,0,1,0,1,0,1,0,0,0],[0,0,1,0,1,0,1,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,1,1,1,1,1,1,1,0,0],[0,1,1,0,1,1,1,1,1,1],[0,1,1,0,1,1,1,1,0,1],[0,1,1,1,1,1,1,1,1,0],[0,1,1,1,1,1,1,1,0,0],[1,0,1,1,1,1,1,0,0,1],[0,1,1,1,1,1,1,1,1,0]]},{name:"leaf",img:"./assets/img/10x10/leaf.png",fieldSize:"10 x 10",level:"medium",table:[[0,0,0,0,1,1,1,1,1,1],[0,0,0,1,0,1,0,1,0,1],[0,0,1,1,0,1,0,1,1,1],[0,1,0,1,0,1,1,0,0,1],[0,1,0,1,0,1,1,1,1,1],[0,1,0,1,1,0,0,0,1,0],[0,1,1,1,1,1,1,1,1,0],[0,0,1,0,0,0,0,1,0,0],[0,1,0,1,1,1,1,0,0,0],[1,1,0,0,0,0,0,0,0,0]]},{name:"tree",img:"./assets/img/10x10/tree.png",fieldSize:"10 x 10",level:"medium",table:[[0,0,1,1,1,1,1,1,0,0],[0,1,1,1,1,0,1,1,1,0],[1,1,1,1,1,0,1,1,1,1],[1,1,0,1,1,1,0,0,1,1],[1,1,1,0,1,1,1,1,1,0],[0,1,1,1,1,1,0,0,0,0],[0,0,0,0,1,1,1,0,0,0],[0,0,0,0,1,1,0,0,0,0],[0,1,0,0,1,1,0,0,0,1],[1,1,1,1,1,1,1,1,1,1]]}],hard:[{name:"bull",img:"./assets/img/15x15/bull.png",fieldSize:"15 x 15",level:"hard",table:[[0,0,1,0,1,0,0,0,0,0,0,0,1,1,0],[0,0,1,0,1,0,0,0,0,0,0,1,0,0,0],[0,0,1,1,1,1,1,0,0,0,0,1,0,0,0],[0,1,1,1,1,1,1,1,1,0,0,1,1,1,0],[1,1,1,1,1,1,1,1,1,1,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,0,1],[1,1,0,0,1,1,1,1,1,1,1,1,1,1,0],[0,0,0,0,1,1,1,1,1,1,1,1,1,1,0],[0,0,0,0,1,1,1,1,1,1,1,1,1,1,0],[0,0,0,0,1,1,1,1,1,1,1,1,1,0,0],[0,0,0,0,1,1,1,1,1,0,1,1,1,1,0],[0,0,0,1,1,1,1,0,0,0,1,1,0,1,0],[0,0,0,1,0,0,1,0,0,0,1,0,0,1,0],[0,0,1,1,0,0,0,1,0,1,0,0,1,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]},{name:"deer",img:"./assets/img/15x15/deer.png",fieldSize:"15 x 15",level:"hard",table:[[1,1,0,1,1,0,0,0,0,0,0,1,1,0,1],[1,1,0,1,1,0,1,0,0,1,0,1,1,0,1],[0,1,1,1,1,0,1,0,0,1,0,1,1,0,1],[0,0,1,1,1,1,1,0,0,0,1,1,1,1,1],[0,0,0,0,1,1,0,1,1,1,1,1,0,0,0],[0,0,0,0,0,0,1,1,1,1,1,1,1,0,0],[0,0,0,0,0,1,0,1,0,1,1,1,1,1,0],[0,0,0,0,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,0,1,1,1,1,1],[0,1,0,1,1,1,0,0,0,0,1,1,1,1,1],[0,1,1,1,1,1,0,0,0,0,1,1,1,1,1],[0,0,1,1,1,0,0,0,0,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,1,1,1,1,1,1]]},{name:"drink",img:"./assets/img/15x15/drink.png",fieldSize:"15 x 15",level:"hard",table:[[0,0,0,0,0,0,0,0,0,0,1,1,1,1,0],[0,0,0,0,0,0,0,0,0,1,0,0,0,1,1],[0,0,0,0,0,0,0,0,1,1,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,0,0,1],[0,1,1,1,0,0,0,0,0,1,1,0,0,1,1],[0,0,1,1,0,0,0,0,0,1,1,1,1,0,0],[0,0,0,1,1,0,0,0,1,1,0,0,0,0,0],[0,0,0,1,1,1,0,1,1,0,0,0,0,0,0],[0,0,0,0,1,1,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,1,1,1,0,0,0,0,0,0,0],[0,0,0,0,0,1,1,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,1,1,1,1,1,0,0,0,0,0,0]]},{name:"mouse",img:"./assets/img/15x15/mouse.png",fieldSize:"15 x 15",level:"hard",table:[[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[0,0,0,0,0,1,1,1,1,0,0,1,1,0,1],[0,0,0,1,1,1,0,0,1,0,0,1,0,1,0],[1,1,1,0,1,0,0,1,1,0,0,1,0,0,0],[1,1,0,0,0,0,0,1,0,0,0,1,1,0,0],[0,1,1,1,1,0,0,1,1,0,0,0,1,1,0],[0,0,0,0,1,1,0,0,1,1,0,0,0,1,1],[0,0,0,0,0,1,0,0,0,1,1,1,0,0,1],[0,0,0,0,0,1,1,0,0,0,0,1,1,0,1],[0,0,0,1,1,1,1,0,0,0,0,0,1,1,1],[0,0,0,1,0,1,0,0,1,1,0,0,0,1,1],[0,0,0,0,0,1,0,0,1,0,0,0,0,1,0],[0,0,0,0,0,0,1,0,1,0,0,0,0,1,0],[0,0,0,0,0,1,1,1,1,1,0,0,1,1,0],[0,0,0,1,1,1,0,1,1,0,1,1,1,0,0]]},{name:"panda",img:"./assets/img/15x15/panda.png",fieldSize:"15 x 15",level:"hard",table:[[0,0,1,1,1,0,0,0,0,0,0,1,1,1,0],[0,1,1,0,1,1,1,1,1,1,1,1,0,1,1],[0,1,1,0,1,1,0,0,0,0,1,1,0,1,1],[0,0,1,1,1,0,0,0,0,0,0,1,1,1,0],[0,0,0,1,0,0,0,0,0,0,0,0,1,0,0],[0,0,1,1,0,0,0,0,0,0,0,0,0,1,0],[0,0,1,0,0,0,1,0,0,0,0,1,0,1,0],[0,1,1,0,0,1,0,1,0,0,1,0,1,0,1],[1,0,1,0,0,1,0,1,0,0,1,0,1,0,1],[1,0,1,0,0,0,1,0,0,0,0,1,0,0,1],[0,0,1,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,1,1,0,0,0,1,1,1,1,0,0,1,1],[0,0,0,1,1,0,0,0,1,1,0,0,1,1,0],[1,0,0,0,1,1,0,0,0,0,0,1,1,1,0],[1,1,1,0,0,0,1,1,1,1,1,1,1,1,0]]}]}},le=({tag:e="div",classes:t,text:s,attr:a})=>{const l=document.createElement(e);if(t&&(Array.isArray(t)?l.classList.add(...t):l.classList.add(t)),s&&(l.textContent=s),a)for(let e in a)l.setAttribute(e,a[e]);return l},ie=(e=0,t)=>Math.floor(Math.random()*(t-e+1))+e,ne="modal-block",oe="modal-block_active",ce="modal-block__window",re={control:"data-modal-control",open:"data-modal-open",close:"data-modal-close",modal:"data-modal-id"},de="closeModalWindow",me="openModalWindow";class he{constructor(e={}){const{attrName:t=re.modal,id:s="modal",content:a=""}=e,l=`[${t}="${s}"]`;document.querySelector(l)||he.createDom(t,s,a),he.eventsBinded||he.bindEvents()}static createDom(e,t,s){const a=le({classes:ne,attr:{[e]:t}}),l=le({classes:ce});l.append(s),a.append(l),document.body.querySelector("script").before(a)}static bindEvents(){document.addEventListener("click",he.clickHandler),he.eventsBinded=!0}static clickHandler(e){e.target.classList.contains(ne)&&he.close(e.target);const t=e.target.closest(`[${re.control}]`);if(!t)return;e.preventDefault();const s=t.hasAttribute(re.open),a=t.hasAttribute(re.close),l=t.getAttribute(re.open)||t.getAttribute(re.close),i=document.querySelector(`[${re.modal}="${l}"]`);return i?s?(document.body.querySelectorAll("."+oe).forEach((e=>{he.close(e)})),void he.open(i)):void(a&&he.close(i)):void 0}static open(e){he.addLock(),he.addModalClasses(e),he.dispatchEvent(e,me)}static close(e){he.removeLock(),he.removeModalClasses(e),he.dispatchEvent(e,de)}static addLock(){const e=he.getScrollWidth();document.body.style.height="100%",document.body.style.overflow="hidden",e&&(document.body.style.paddingRight=e+"px")}static getScrollWidth(){return window.innerWidth-document.body.clientWidth}static addModalClasses(e){e.classList.add(oe)}static removeLock(){document.body.style.paddingRight="",document.body.style.height="",document.body.style.overflow=""}static removeModalClasses(e){e.classList.remove(oe)}static dispatchEvent(e,t){const s=new CustomEvent(t,{bubbles:!0});e.dispatchEvent(s)}}const ge="hamburger",ue="hamburger__box",pe="hamburger__inner",be="hamburger_type_slider",ve="hamburger_active";class fe{constructor(){return fe.bindEvents(),fe.create()}static bindEvents(){fe.binded||(document.addEventListener("click",(e=>{const t=e.target.closest(`.${ge}`);t&&t.classList.toggle(ve)})),fe.binded=!0)}static create(){const e=le({tag:"button",classes:[ge,be]}),t=le({tag:"span",classes:ue}),s=le({tag:"span",classes:pe});return e.append(t),t.append(s),e}}const _e="theme-switcher",Se="theme-switcher__checkbox",ye="theme-switcher__switch",xe="theme-switcher__slider",we="theme-switcher__text",De="light-theme",Le="dark-theme";class ke{constructor(){const e=localStorage.getItem("theme")||"light";document.querySelector(`.${Se}`);let t=!1;return"light"===e?ke.setLightTheme():(t=!0,ke.setDarkTheme()),ke.bindEvents(),ke.create(t)}static bindEvents(){ke.binded||(document.addEventListener("click",(e=>{const t=e.target.closest(`.${_e}`);if(!t)return;t.querySelector(`.${Se}`).checked?ke.setDarkTheme():ke.setLightTheme()})),ke.binded=!0)}static create(e){const t=le({classes:_e}),s=le({tag:"input",classes:Se,attr:{type:"checkbox",id:"theme-switch"}});s.checked=e;const a=le({tag:"label",classes:ye}),l=le({classes:xe}),i=le({tag:"span",classes:we,text:"Dark theme"});return t.append(a),a.append(s,l,i),t}static setDarkTheme(){document.body.classList.remove(De),document.body.classList.add(Le),localStorage.setItem("theme","dark")}static setLightTheme(){document.body.classList.remove(Le),document.body.classList.add(De),localStorage.setItem("theme","light")}}const Ee={check:new Audio("./assets/sounds/check.mp3"),cross:new Audio("./assets/sounds/cross.mp3"),win:new Audio("./assets/sounds/win.mp3")};class $e{constructor(){this.startNewGame(),this.bindEvents()}startNewGame(e,t,s){this.stopTimer(),this.gameEnded=!1,this.timerId=null,this.timerValue=s||0,this.scheme=e||this.getRandomScheme("easy"),this.soundDisabled=JSON.parse(localStorage.getItem("sound-disabled")),this.createDom(),this.fieldDom=this.getFieldDom(),this.saveBtnDom=document.querySelector(`.${T}`),this.loadBtnDom=document.querySelector(`.${q}`),this.timerDom=document.querySelector(`.${a}`),this.winModalDom=document.querySelector('[data-modal-id="win-modal"]'),this.winTitleDom=this.winModalDom.querySelector(`.${X}`),this.getSavedGame()?this.loadBtnDom.disabled=!1:this.loadBtnDom.disabled=!0,t&&this.writeMoves(t),this.setTimerValue(this.timerValue),this.saveBtnDom.disabled=!1;const l=document.querySelector(`.${D}`);this.soundDisabled&&l.classList.add(L)}startTimer(){this.timerId=setInterval((()=>{this.setTimerValue(this.timerValue+1)}),1e3)}stopTimer(){clearInterval(this.timerId),this.timerId=null}createDom(){const t=document.querySelector(`.${o}`);if(t)t.replaceWith(this.createTableDom());else{const t=le({classes:e}),s=this.createHeaderDom(),a=this.createMainDom(),l=this.createSelectorDom();t.append(s,l,a),document.body.append(t),this.createModalsDom()}}createHeaderDom(){const e=le({tag:"header",classes:n}),t=new ke,s=le({tag:"button",classes:[w,D]});return e.append(t,s),e}createMainDom(){const e=le({tag:"main",classes:t}),s=le({tag:"h1",classes:[G,l],text:"Nonograms"}),i=le({tag:"p",classes:[V,a]}),n=this.createTableDom(),o=this.createControlsDom();return e.append(s,i,n,o),e}createControlsDom(){const e=le({classes:i}),t=le({tag:"button",classes:[w,k,E],text:"Reset game"}),s=le({tag:"button",classes:[w,k,M],text:"Solution"}),a=le({tag:"button",classes:[w,k,$],text:"Random game"}),l=le({tag:"button",classes:[w,k,T],text:"Save game"}),n=le({tag:"button",classes:[w,k,q],text:"Continue last game"}),o=le({tag:"button",classes:[w,k,z],text:"Last wins",attr:{"data-modal-open":"records-modal","data-modal-control":""}});return e.append(t,s,a,l,n,o),e}createTableDom(){const e=this.getHHintsArr(),t=this.getVHintsArr(),s=this.scheme.table[0].length,a=this.scheme.table.length,l=Math.max(...e.map((e=>e.length))),i=Math.max(...t.map((e=>e.length))),n=le({classes:[o,r]}),y=le({classes:[d]}),x=this.createTablePart({container:{classes:[m]},row:{classes:[h],quantity:s},cell:{classes:[c,g],quantity:i}}),w=this.createTablePart({container:{classes:[u]},row:{classes:[p,b],quantity:a},cell:{classes:[c,v],quantity:l}}),D=this.createTablePart({container:{classes:[f]},row:{classes:[p,_],quantity:a},cell:{classes:[c,S],quantity:s}});return n.append(y,x,w,D),this.writeHints(n,e,t),n}createTablePart({container:e,row:t,cell:s}){const a=le({classes:e.classes});for(let e=0;e<t.quantity;e++){const e=le({classes:t.classes});for(let t=0;t<s.quantity;t++){const t=le({classes:s.classes});e.append(t)}a.append(e)}return a}createSelectorDom(){const e=le({classes:I}),t=le({tag:"h2",classes:[G,R],text:"List of games"}),s=le({classes:B});e.append(t,s);for(let e in ae.levels){const t=le({classes:O}),a=le({tag:"p",classes:[H,F],text:e}),l=le({tag:"ul",classes:W});ae.levels[e].forEach((t=>{const s=le({tag:"li",classes:J}),a=le({tag:"a",classes:P,attr:{href:"#","data-level":e,"data-name":t.name}}),i=le({tag:"img",classes:j,attr:{src:t.img,alt:""}}),n=le({classes:Y}),o=le({tag:"p",classes:[N,K],text:t.name}),c=le({tag:"p",classes:Q,text:`Size: ${t.fieldSize}`});s.append(a),a.append(i,n),n.append(o,c),l.append(s)})),t.append(a,l),s.append(t)}const a=le({classes:C}),l=new fe;return l.classList.add(A),a.append(l),e.append(a),e}createModalsDom(){const e=le({classes:[U]}),t=le({tag:"h2",classes:[V,X],text:"Great! You have solved the nonogram in ## seconds!"});e.append(t),new he({id:"win-modal",content:e});const s=le({classes:[U]}),a=le({tag:"h2",classes:[V,X],text:"Last wins"}),l=this.createResultsList();s.append(a,l),new he({id:"records-modal",content:s})}createResultsList(){const e=le({tag:"table",classes:Z}),t=le({tag:"tbody"}),s=le({tag:"tr",classes:ee}),a=["Image","Name","Size","Level","Time"];for(let e of a)s.append(le({tag:"th",classes:te,text:e}));e.append(t),t.append(s);const l=JSON.parse(localStorage.getItem("game-results"));return l?(l.sort(((e,t)=>e.timerValue-t.timerValue)),l.forEach((e=>{const s=le({tag:"tr"}),{img:l,name:i,fieldSize:n,level:o,timerValue:c}=e;for(let e of a){const t=le({tag:"td",classes:te});switch(e){case"Image":const e=le({tag:"img",classes:se,attr:{src:l,alt:""}});t.append(e);break;case"Name":t.textContent=i;break;case"Size":t.textContent=n;break;case"Level":t.textContent=o;break;case"Time":t.textContent=this.getTimeInFormat(c)}s.append(t)}t.append(s)})),e):e}getRandomScheme(e){let t=e;if(!t){const e=Object.keys(ae.levels);t=e[ie(0,e.length-1)]}const s=ae.levels[t];let a=null;do{a=s[ie(0,s.length-1)]}while(a===this.scheme);return a}getHHintsArr(){return this.scheme.table.map((e=>e.join("").split("0").filter((e=>e.length>0)).map((e=>e.length))))}getVHintsArr(){let e=[];const t=this.scheme.table,s=t[0].length-1;for(let a=0;a<=s;a++){let s="";for(let e of t)s+=e[a];const l=s.split("0").filter((e=>e.length>0)).map((e=>e.length));e.push(l)}return e}writeMoves(e){e.forEach(((e,t)=>{e.forEach(((e,s)=>{1===e?this.fieldDom[t][s].classList.add(y):-1===e&&this.fieldDom[t][s].classList.add(x)}))}))}setTimerValue(e){this.timerValue=e,this.timerDom.textContent=this.getTimeInFormat(e)}getTimeInFormat(e){const t=String(Math.floor(e/60)).padStart(2,"0");return`${t}:${String(e-60*t).padStart(2,"0")}`}getFieldDom(){const e=[];return document.querySelectorAll(`.${_}`).forEach((t=>{e.push([...t.children])})),e}bindEvents(){document.addEventListener("click",this.clickHandler.bind(this)),document.addEventListener("contextmenu",this.contextMenuHandler.bind(this))}clickHandler(t){if(t.target.closest(`.${$}`))return void this.startNewGame(this.getRandomScheme());if(t.target.closest(`.${q}`)){const e=this.getSavedGame();return void(e&&this.startNewGame(e.scheme,e.moves,e.timerValue))}if(t.target.closest(`.${E}`))return void this.resetGame();if(t.target.closest(`.${M}`))return void this.solveGame();if(t.target.closest(`.${T}`))return void this.saveGame();const a=t.target.closest(`.${S}`);if(a)return void this.cellClickHandler(t,a);if(t.target.closest(`.${A}`))return void document.querySelector(`.${e}`).classList.toggle(s);const l=t.target.closest(`.${D}`);if(l)return this.soundDisabled=!this.soundDisabled,localStorage.setItem("sound-disabled",JSON.stringify(this.soundDisabled)),void l.classList.toggle(L);const i=t.target.closest(`.${P}`);if(i){t.preventDefault();const e=i.getAttribute("data-level"),s=i.getAttribute("data-name"),a=ae.levels[e].filter((e=>e.name===s))[0];this.startNewGame(a)}else;}solveGame(){this.endGame(),this.clearField(),this.scheme.table.forEach(((e,t)=>{e.forEach(((e,s)=>{const a=this.fieldDom[t][s];e&&a.classList.add(y)}))}))}saveGame(){const e={scheme:this.scheme,timerValue:this.timerValue,moves:this.getMoves()};localStorage.setItem("game-save",JSON.stringify(e)),this.loadBtnDom.disabled=!1}getSavedGame(){return JSON.parse(localStorage.getItem("game-save"))}getMoves(){return this.fieldDom.map((e=>e.map((e=>e.classList.contains(y)?1:e.classList.contains(x)?-1:0))))}resetGame(){this.gameEnded=!1,this.saveBtnDom.disabled=!1,this.clearField(),this.stopTimer(),this.setTimerValue(0)}clearField(){document.querySelectorAll(`.${y}`).forEach((e=>{e.classList.remove(y)})),document.querySelectorAll(`.${x}`).forEach((e=>{e.classList.remove(x)}))}writeHints(e,t,s){e.querySelectorAll(`.${b}`).forEach(((e,s)=>{const a=[...e.children].reverse();t[s].reverse().forEach(((e,t)=>a[t].textContent=e))})),e.querySelectorAll(`.${h}`).forEach(((e,t)=>{const a=[...e.children].reverse();s[t].reverse().forEach(((e,t)=>a[t].textContent=e))}))}cellClickHandler(e,t){e.preventDefault(),this.gameEnded||(this.timerId||this.startTimer(),t.classList.remove(x),t.classList.toggle(y),this.soundDisabled||Ee.check.play(),this.checkState())}contextMenuHandler(e){const t=e.target.closest(`.${S}`);t&&(e.preventDefault(),this.gameEnded||(this.timerId||this.startTimer(),t.classList.remove(y),t.classList.toggle(x),this.soundDisabled||Ee.cross.play(),this.checkState()))}checkState(){this.isSolved()&&this.endGame(!0)}isSolved(){return this.scheme.table.every(((e,t)=>e.every(((e,s)=>!!e==!!this.fieldDom[t][s].classList.contains(y)))))}endGame(e){this.stopTimer(),this.gameEnded=!0,e&&(this.saveResult(),this.winTitleDom.textContent=`Great! You have solved the nonogram in ${this.timerValue} seconds!`,document.querySelector(`.${Z}`).replaceWith(this.createResultsList()),he.open(this.winModalDom),this.soundDisabled||Ee.win.play()),this.saveBtnDom.disabled=!0}saveResult(){const e={timerValue:this.timerValue,name:this.scheme.name,level:this.scheme.level,img:this.scheme.img,fieldSize:this.scheme.fieldSize};let t=JSON.parse(localStorage.getItem("game-results"));t?(t.unshift(e),t.length>5&&(t.length=5)):t=[e],localStorage.setItem("game-results",JSON.stringify(t))}}document.addEventListener("DOMContentLoaded",(()=>{new $e}))})();